import java.util.ArrayList;
import java.util.Arrays;
import Jama.*;

//?????????
public class MatrixCal {

	public static enum CAL_TYPE {DETERMINANT,RANK,MULTIPLICATION,TRANSPOSE,LUDECOMPOSITION;} //????????
	public static Matrix matrixA=null;//????A???????????????
	public static void main(String[] args) {
		try{
			calMatrix("1.1 2 3 \n4 5  6\n7  -8 9",CAL_TYPE.LUDECOMPOSITION);
		}catch (Exception e){
			setTip("?????????????????");
		}
		
	}
	

	//?????????
	public static void setTip(String s){
		
	}
	
	//???????????
	public static void clear(){
		
	}
	
	//????????????????
	public static double[][] StringToArray(String s) throws Exception{
		int rowCount=0;//????????
		int columnCount=0;//????????
		String[] sourceStrArray = s.split("\n");//???忪??????戒??
		double[][] ansArray = null;//????
		//??????????忱???忌?
		ArrayList<String> arrayList = new ArrayList<String>(Arrays.asList(sourceStrArray));
		//???????????完????
		for(int i=0;i<arrayList.size();i++){
			if(arrayList.get(i).trim().equals("")){
				arrayList.remove(i--);
			}
		}
		rowCount = arrayList.size();//???????????
		
		//?????????????
		for(int i=0;i<rowCount;i++){
			
			sourceStrArray[i] = sourceStrArray[i].trim();//?????????
			String[] itemArray = sourceStrArray[i].split("( )+");//??????????快??????戒??
			
			//??????????快????????????????
			if(i==0){
				for(String itemStr : itemArray){
					if(!itemStr.trim().equals("")){
						columnCount++;
					}
				}
				ansArray = new double[rowCount][columnCount];//????????????
			}
				//??????i???快????????,???????????????????
				for(int j=0;j<itemArray.length;j++){
					ansArray[i][j] = Double.parseDouble(itemArray[j]);
				}

		}
		return ansArray;
	}
	
	
	//????????????????
	public static String ArrayToString(double[][] matrixArray){
		String s = "";
		for(int i = 0;i<matrixArray.length;i++){
			for(int j = 0;j<matrixArray[0].length;j++){
				if(matrixArray[i][j]%1 == 0){
					s+=((int)matrixArray[i][j]+" ");
				}else{
					s+=(matrixArray[i][j]+" ");
				}
			}
			s+="\n";
		}
		return s;
	}
	
	public static void addString(String s){
		System.out.println(s);
	}
	
	//???????
	public static void calMatrix(String s, CAL_TYPE type) throws Exception{
		
		double [][] matrixArray = null;//????????
		matrixArray = StringToArray(s);
		
		Matrix matrix = new Matrix(matrixArray);//???????????
		//????????????????
		switch(type){

		case DETERMINANT://?????
			try{
				double detNum = matrix.det();
				addString("\n????????????:"+detNum);
			}catch(IllegalArgumentException e){
				setTip("????????????????");
			}
			
			break;
		case RANK://????
			int n = matrix.rank();
			addString("\n?????????:"+n);
			break;
		case TRANSPOSE://???
			double[][] tranMatrix = matrix.transpose().getArray();
			addString("\n?????????????:"+ArrayToString(tranMatrix));
			break;
		case MULTIPLICATION://???
			if(matrixA != null){
				double[][] mulMatrix=matrixA.times(matrix).getArray();
				addString("\n????A?????B??????:"+ArrayToString(mulMatrix));
			}else{
				matrixA = matrix;
			}
			break;
		case LUDECOMPOSITION://LU???
			LUDecomposition lu = matrix.lu();
			addString("L?:\n"+ArrayToString(lu.getL().getArray()));
			addString("\nU?:\n"+ArrayToString(lu.getU().getArray()));
		}
		
	}
}
